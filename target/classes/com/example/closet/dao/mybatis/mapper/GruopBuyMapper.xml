<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper
	namespace="com.example.closet.dao.mybatis.mapper.GroupBuyMapper">
	<cache />
	
	<insert id="insertGroupBuyProduct">
		INSERT ALL INTO PRODUCT (PRODUCTID, USERID, CATEGORYID, NAME,
		DESCRIPTION, TYPE,
		STATUS, REGISTERDATE, PERIOD, COLOR, "size",
		PICTURE1, PICTURE2, PICTURE3, PICTURE4)
		VALUES (#{productId}, #{userId},
		#{categoryId}, #{name}, #{description}, #{type},
		#{status},
		#{registerDate}, #{period},
		#{color}, #{size}, #{picture1},
		#{picture2},
		#{picture3}, #{picture4})
		INTO GROUPBUY
		(PRODUCTID, PRICE, PEOPLENUM)
		VALUES (#{productId}, #{price}, #{peapleNum})
		SELECT *
        FROM DUAL;
	</insert>
	
	<select id="getPeopleNum" resultType="Integer">
		SELECT PEOPLENUM
		FROM GroupBuy
		WHERE PRODUCTID = #{productId}
	</select>
	
	<select id="getGroupBuyDetail" resultType="GroupBuy">
		SELECT p.PRODUCTID, p.NAME, p.DESCRIPTION, p.CATEGORYID, g.PRICE, g.PEOPLENUM
		FROM PRODUCT p, GROUPBUY g
		WHERE PRODUCTID = #{productId} AND p.productId = g.productId
	</select>

</mapper>